<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Checkout | GM3A</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background: #fff;
      color: #000;
      font-family: Arial, Helvetica, sans-serif;
    }
    header {
      padding: 20px;
      border-bottom: 1px solid #ccc;
      text-align: center;
    }
    .btn-black {
      background: #000;
      color: #fff;
      padding: 10px 22px;
      text-decoration: none;
      font-weight: 600;
      text-transform: uppercase;
      border: 1px solid #000;
      display: inline-block;
      cursor: pointer;
    }
    .btn-black:hover {
      background: #fff;
      color: #000;
    }
    .checkout-box {
      max-width: 900px;
      margin: 60px auto;
    }
    .cart-box {
      border: 1px solid #ccc;
      padding: 20px;
      margin-bottom: 30px;
    }
    .cart-item {
      display: flex;
      justify-content: space-between;
      border-bottom: 1px solid #eee;
      padding: 8px 0;
    }
    .remove {
      color: red;
      cursor: pointer;
      font-size: 14px;
    }
  </style>
</head>
<body>

<header class="py-3">
  <nav class="container d-flex align-items-center justify-content-between">
    
    <div class="d-flex gap-2">
      <a href="home.html" class="btn btn-black btn-sm">Home</a>
      <a href="collection.html" class="btn btn-black btn-sm">Collection</a>
      <a href="index.html" class="btn btn-black btn-sm">About</a>
    </div>

    <div class="brand-block">
      <a href="#">
        <img src="images/logo1.png" alt="GM3A" class="brand-image" style="height: 40px;">
      </a>
    </div>

    <div>
      <a href="profil.html" class="btn btn-black btn-sm nav-login">Profil</a>
    </div>

  </nav>
</header>

<div class="checkout-box">

  <!-- RINGKASAN KERANJANG -->
  <div class="cart-box">
    <h5>Ringkasan Pesanan</h5>
    <div id="cartList"></div>
    <strong>Total: Rp <span id="total">0</span></strong>
  </div>

  <!-- FORM CHECKOUT -->
  <form>
    <div class="row">
      <div class="col-md-6 mb-3">
        <label class="form-label">Nama Lengkap</label>
        <input type="text" class="form-control" required>
      </div>
      <div class="col-md-6 mb-3">
        <label class="form-label">Nomor WhatsApp</label>
        <input type="tel" class="form-control" required>
      </div>
    </div>

    <div class="mb-3">
      <label class="form-label">Alamat Pengiriman</label>
      <textarea class="form-control" rows="3" required></textarea>
    </div>

    <div class="mb-4">
      <label class="form-label">Metode Pembayaran</label>
      <select class="form-control" required>
        <option value="">Pilih metode</option>
        <option>Transfer Bank</option>
        <option>COD</option>
        <option>E-Wallet</option>
      </select>
    </div>

    <div class="text-center">
      <a class="btn-black" onclick="submitOrder()">Konfirmasi Pesanan</a>
    </div>
  </form>
</div>

<footer>
  <div id="footer-bottom">
    <div class="container">
      <div class="row d-flex flex-wrap justify-content-between mb-3">
        <div class="col-md-4 col-sm-6">
          <div class="Shipping d-flex">
            <p>We ship with:</p>
            <div class="card-wrap">
              <img src="images/dhl.png" alt="visa">
              <img src="images/shippingcard.png" alt="mastercard">
            </div>
          </div>
        </div>
        <div class="col-md-4 col-sm-6">
          <div class="payment-method d-flex justify-content-md-center">
            <p>Metode Pembayaran:</p>
            <div class="card-wrap">
              <img src="images/visa.jpg" alt="visa">
              <img src="images/mastercard.jpg" alt="mastercard">
              <img src="images/paypal.jpg" alt="paypal">
            </div>
          </div>
        </div>
        <div class="col-md-4 col-sm-12 text-md-end">
          <p>Â© 2026 GM3A Fashion. All Rights Reserved.</p>
      </div>
    </div>
  </div>
</footer>

<script>
  let cart = JSON.parse(localStorage.getItem('cart')) || [];

  function renderCart() {
    const cartList = document.getElementById('cartList');
    const totalEl = document.getElementById('total');
    cartList.innerHTML = '';
    let total = 0;

    cart.forEach((item, index) => {
      total += item.price;
      cartList.innerHTML += `
        <div class="cart-item">
          <span>${item.name}</span>
          <span>
            Rp ${item.price.toLocaleString('id-ID')} 
            <span class="remove" onclick="removeItem(${index})">Hapus</span>
          </span>
        </div>`;
    });

    totalEl.innerText = total.toLocaleString('id-ID');
    localStorage.setItem('cart', JSON.stringify(cart));
  }

  function removeItem(index) {
    cart.splice(index, 1);
    renderCart();
  }

  function submitOrder() {
    if (cart.length === 0) {
      alert('Keranjang kosong');
      return;
    }
    alert('Pesanan berhasil dikirim!');
    localStorage.removeItem('cart');
  }

  renderCart();

function submitOrder() {
  if (cart.length === 0) {
    alert('Keranjang kosong');
    return;
  }

  const currentUser = localStorage.getItem('currentUser');
  let orders = JSON.parse(localStorage.getItem('orders')) || [];

  const newOrder = {
    user: currentUser,
    items: cart,
    total: cart.reduce((sum, i) => sum + i.price, 0),
    date: new Date().toLocaleString('id-ID'),
    invoice: 'GM3A-' + Date.now()
  };

  // simpan ke histori
  orders.push(newOrder);
  localStorage.setItem('orders', JSON.stringify(orders));

  // simpan PESANAN TERAKHIR untuk STRUK
  localStorage.setItem('lastOrder', JSON.stringify(newOrder));

  // bersihkan keranjang
  localStorage.removeItem('cart');

  // pindah ke struk
  window.location.href = 'struk.html';
}
</script>

</body>
</html>
